# ๐ฎ๐ท Humaan โ ุฑุงูููุง ูุฎุตูุต ุฏุณุชุงุฑูุง AI

ุงู ุณูุฏ ูุณุฎูโ ูุดุฑุฏู ู ุณุงุฎุชุงุฑููุฏ README ุงุณุช ุชุง ูุฑ ุนุงูู ุง ุฏุณุชุงุฑ ููุดููุฏ ุจุชูุงูุฏ ุณุฑุนุงู ููุทู ูพุฑูฺู ุฑุง ุฏุฑฺฉ ฺฉูุฏุ ูุงุจุณุชฺฏโูุง ุฑุง ุจุดูุงุณุฏ ู ุชุบุฑุงุช ูุฏูููุฏ ุงุฌุงุฏ ฺฉูุฏ.

---

## 1. TL;DR

- **ูุฑููุฑฺฉ:** SvelteKit (CSR only) + Viteุ ุขุฏุงูพุชุฑ ุงุณุชุงุชฺฉ @sveltejs/adapter-static (@src/routes/+layout.jsุ @svelte.config.js).
- **ูุณุชูโ ูุญุตูู:** ููุดู ุณูโุจุนุฏ ุชุนุงูู ุงุฑุงู ุจุง Three.js ฺฉู ุฏุฑ ฺฉุงููพูููุช `IranMap3D` ูพุงุฏู ุดุฏู ู ุงุฒ ฺฉุงููฺฏ ฺฏุณุชุฑุฏูโ `MAP_CONFIG` ุชุบุฐู ูโฺฉูุฏ (@src/lib/components/iran/IranMap3D.svelteุ @src/lib/config.js).
- **ุฑุงุจุท ฺฉุงุฑุจุฑ:** ุตูุญูโ ุงุตู `/` ุจุง `<Iran />` ุดุงูู ฺฉูุชุฑูโูุง ฺุฑุฎุดุ ููุงุด ุขุจโูุงุ ูพูู ุชูุธูุงุช ู ูพูู ุงุทูุงุนุงุช (@src/routes/+page.svelteุ @src/lib/components/iran).
- **ุฏุชุงุณุช ุฌุงูุจ:** `cityStore` ุดุงูู ูุฎุชุตุงุช ุดูุฑูุง ู ูุชุฏ `fetchWeather` ฺฉู ุงุฒ Open-Meteo ุฏุงุฏูโ ุขุจโูููุง ูโฺฏุฑุฏ (@src/lib/stores/cityStore.js).


## 2. ูพุดุชู ู ูุงุจุณุชฺฏโูุง

| ููุน | ุฌุฒุฆุงุช |
| --- | --- |
| UI | Svelte 5ุ SvelteKit 2 |
| ุฑูุฏุฑ ุณูโุจุนุฏ | `three`, OrbitControls, EffectComposer, UnrealBloomPass |
| ุฏุงุฏู/ูููุฏุงุฑ | `d3-scale`, `d3-format`, `layerchart`, `svelte-ux` |
| CSS & ูููุช | Tailwind plugins (typography/forms)ุ ูููุช Vazirmatn CDN |

ุงุณฺฉุฑูพุชโูุง npm (package.json):

```bash
npm install      # ูุตุจ
npm run dev      # ุชูุณุนู ุจุง Vite
npm run build    # ุฎุฑูุฌ ุงุณุชุงุชฺฉ
npm run preview  # ูพุดโููุงุด ุฎุฑูุฌ
npm run check    # svelte-check + type checking
```


## 3. ูุณุฑ ุฑุงูโุงูุฏุงุฒ

1. Node.js โฅ 18 (ุชุฑุฌุญุงู 20) ูุตุจ ุจุงุดุฏ.
2. `npm install`
3. `npm run dev` ู ุณูพุณ ุจุงุฒุฏุฏ ุงุฒ `http://localhost:5173`
4. ุฎุฑูุฌ ุงุณุชุงุชฺฉ: `npm run build` โ ูููุฏุฑ `build/` ุฌูุช ูุฒุจุงู ุฑู CDN ุง ูุฑ ูุงุณุช ุงุณุชุงุชฺฉ.


## 4. ุณุงุฎุชุงุฑ ูพูุดูโูุง (ุญุฏุงูู)

```
src/
โโ lib/
โ  โโ components/
โ  โ  โโ iran/         # IranMap3D + Iran wrapper + ฺฉูุชุฑูโูุง
โ  โ  โโ ControlPanel.svelte
โ  โโ stores/          # cityStoreุ provinceDataStore
โ  โโ utils/logger.js
โ  โโ config.js        # MAP_CONFIG ู ุฑูฺฏโูุง
โโ routes/
   โโ +page.svelte     # ูุฑูุฏ ุงุตู (ููุงุด Iran component)
   โโ (auth), dashboard/...
static/
โโ iran.svg, user.svg, sounds/...
```

ุจุฑุง ูุทุงูุนูโ ูุณุฎูโ HTML ูุฏูุ ุจู `html/` ูุฑุงุฌุนู ฺฉูุฏ (README ุฌุฏุงฺฏุงูู ุฏุงุฑุฏ).


## 5. ุฌุฑุงู ุงุฌุฑุง ุตูุญู ุงุตู

1. ูุงู `src/routes/+page.svelte` ููุท `<Iran />` ุฑุง ุฑูุฏุฑ ูโฺฉูุฏ.
2. `src/lib/components/iran/Iran.svelte`:
   - CSS Variables ูพุณโุฒููู ุฑุง ุทุจู `BACKGROUND_COLORS` ุณุช ูโฺฉูุฏ.
   - ฺฉูุชุฑู ูุถุนุช ูพููโูุงุ ุฏฺฉููโูุง ู ุงููุชโูุง ููุดู ุฑุง ุจุฑ ุนูุฏู ุฏุงุฑุฏ.
3. `IranMap3D.svelte`:
   - ุตุญููโ Three.jsุ OrbitControlsุ Bloom ู ููุฏููฺฏ Hover/Select ุฑุง ูุฏุฑุช ูโฺฉูุฏ.
   - ุชูุงุจุน `toggleRotation`, `toggleWater`, `resetView`, `zoomIn/Out`, `updateSize`, ... ุฑุง ุงฺฉุณูพูุฑุช ูโฺฉูุฏ ุชุง ุณุงุฑ ฺฉุงููพูููุชโูุง ุจุชูุงููุฏ ูุณุชููุงู ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดูุฏ.
4. `ControlPanel.svelte`:
   - ฺฉูุฏูุงฺูโ `mapComponent.applyConfigChanges` ุฑุง ุตุฏุง ูโุฒูุฏ ุชุง ุชูุธูุงุช ูุญุธูโุง ุฏุฑ ุตุญูู ุจูโุฑูุฒุฑุณุงู ุดููุฏ (ุจุฏูู ุฑูุฑุด).
5. `InfoPanel` ู `MapControls` ูุตุฑูโฺฉููุฏูโ ุฑูุฏุงุฏูุง `provinceHover` ู ุงฺฉุดูโูุง ุฏุณุช ฺฉุงุฑุจุฑ ูุณุชูุฏ.


## 6. ฺฉุงููฺฏ ู ุดุฎุตโุณุงุฒ

- **ูุงู ุงุตู:** `src/lib/config.js`
  - ุดุงูู ุชูุงู ูพุงุฑุงูุชุฑูุง ุดฺฉูโุฏู ุงุณุชุงูโูุงุ ุฏุฑุงูุงุ Bloomุ ุฏูุฑุจูุ ููุฑูพุฑุฏุงุฒุ ูพุณโุฒููู ู ุฑูฺฏโุจูุฏ ููุงุทู.
  - ููุฏุงุฑ `SHOW_CONTROL_PANEL` ุชุนู ูโฺฉูุฏ ุขุง ูพูู ุชูุธูุงุช ุจูโุตูุฑุช ูพุดโูุฑุถ ููุงุด ุฏุงุฏู ุดูุฏ ุง ูู.
- **ูููููโ ุฌุฏุงุดุฏู:** `sample-config-iran.md`
  - ุฎุฑูุฌ ุชุงุจุน ยซฺฉูพ ุชูุธูุงุชยป ุฏุงุฎู ControlPanel ุงุณุช (ููุงุณุจ ุจุฑุง ุงุดุชุฑุงฺฉโฺฏุฐุงุฑ preset).
- **ูพุดููุงุฏ ุจุฑุง AI:**
  1. ุจุฑุง ุชุบุฑุงุช ฺฏุณุชุฑุฏูุ ูุณุฎูโ ุณูุงุฑุด `MAP_CONFIG` ุจุณุงุฒุฏ ู ุขู ุฑุง ุงุฒ ุทุฑู prop `customConfig` ุจู `<Iran />` ูพุงุณ ุฏูุฏ.
  2. ุฑูฺฏโูุง ูพุณโุฒููู ุฑุง ุจุง `customBackgroundColors` ุง ูุณุชููุงู ุจุง CSS variables (`--bg-primary`, `--bg-secondary`) ฺฉูุชุฑู ฺฉูุฏ.
  3. ููฺฏุงู ุงูุฒูุฏู ูพุงุฑุงูุชุฑ ุฌุฏุฏุ ูุณุฑ ุขูพุฏุช ุฑุง ุฏุฑ ControlPanel ูุฒ ุงุถุงูู ฺฉูุฏ ุชุง UI ุขู ุฑุง ูพุดุชุจุงู ฺฉูุฏ.


## 7. ุฏุงุฏู ู ุงุณุชูุฑูุง

- `cityStore.js`: ุดุงูู ูุณุช ุดูุฑูุง ุจุง ูุฎุชุตุงุช ุฌุบุฑุงูุงุ ุงุณุชูุฑ `selectedCity`, `weatherData` ู ุชุงุจุน `fetchWeather`.
- `fetchWeather`: ุงุฒ Open-Meteo API ุงุณุชูุงุฏู ูโฺฉูุฏุ ูพุณ ูุงุฒ ุจู ุงุชุตุงู ุงูุชุฑูุช ุฏุฑ ุฒูุงู ุงุฌุฑุง ุฏุงุฑุฏ.
- `provinceToCity`: ูฺฏุงุดุช ูุงู ุงุณุชุงู (ุฑู ููุดู) ุจู ุดูุฑ ููุงูุฏู ุจุฑุง ุฏุฑุฎูุงุณุช ููุงุดูุงุณ.

> ุงฺฏุฑ ูุตุฏ ุฏุงุฑุฏ ุฏุงุฏูโ ุฏฺฏุฑ (ูุซูุงู ุฌูุนุช ุง ุดุงุฎุต ุงูุชุตุงุฏ) ุฑุง ููุงุด ุฏูุฏุ ูโุชูุงูุฏ ุงุณุชูุฑ ุฌุฏุฏ ุงุฌุงุฏ ฺฉุฑุฏู ู ุขู ุฑุง ุจู InfoPanel ุง Tooltipูุง IranMap3D ุชุฒุฑู ฺฉูุฏ.


## 8. ุงุณุชุงู ู ุฏุงุฑุงโูุง

- ูููุช Vazirmatn ุงุฒ CDN ููุฏ ูโุดูุฏ (`<svelte:head>` ุฏุฑ +page.svelte).
- ุงุณุชุงูโูุง Tailwind ุฏุฑ ฺฉู ูพุฑูฺู ูุนุงูโุงูุฏุ ุงูุง ุจุดุชุฑ UI ุณูุงุฑุด ุฏุงุฎู ุฎูุฏ ฺฉุงููพูููุชโูุง ููุดุชู ุดุฏู ุงุณุช.
- ุฏุงุฑุงโูุง SVG ู ุตุฏุงูุง ุฏุฑ `static/` ูุฑุงุฑ ุฏุงุฑูุฏุ Vite ุขูโูุง ุฑุง ุจโูุงุณุทู ุณุฑู ูโฺฉูุฏ.


## 9. ุฏูพูู ู ูุงุณุชูฺฏ

- ุจู ุฏูู `ssr = false` ู `prerender = true`ุ ุฎุฑูุฌ build ฺฉ ุณุงุช ฺฉุงูู ุงุณุชุงุชฺฉ ุงุณุช. ูโุชูุงูุฏ ุขู ุฑุง ุจุฑ ุฑู GitHub Pagesุ Vercel (Static) ุง ูุฑ ูุงุณุช S3/CF Workers ูุฑุงุฑ ุฏูุฏ.
- ุจุฑุง ูุญุท Nodeุ ุฏุฑ ุตูุฑุช ูุงุฒ ูโุชูุงู adapter-node ุฑุง ูุนุงู ฺฉุฑุฏ ูู ุฏุฑ ุญุงู ุญุงุถุฑ config ููุท static ุงุณุช.


## 10. ฺฺฉโูุณุช ุชูุณุนู ุจุฑุง ุนุงููโูุง AI

1. **ูุจู ุงุฒ ุชุบุฑ Three.js**: ูุทูุฆู ุดูุฏ ฺฉู ูุฑ ุชุงุจุน ุฌุฏุฏ ุฑู `mapComponent` bind ุดูุฏ ุชุง ControlPanel ุจุชูุงูุฏ ุขู ุฑุง ุตุฏุง ุจุฒูุฏ.
2. **ููฺฏุงู ุงูุฒูุฏู datasource ุฌุฏุฏ**: ุงุณุชูุฑ ูุฌุฒุง ุงุฌุงุฏ ฺฉูุฏ ู ุงุฒ Svelte store ุงุณุชูุงุฏู ฺฉูุฏ ุชุง ฺฉุงููพูููุชโูุง ูุงฺฉูุด ุจูุงููุฏ.
3. **ุจุฑุง ูุงูุชูุฑูฺฏ ุฎุทุง**: ูุงู `src/lib/utils/logger.js` ุฑุง ฺฏุณุชุฑุด ุฏูุฏุ ุฏุฑ ุญุงู ุญุงุถุฑ ููุท wrapper ุณุงุฏู ุจุฑุง console ุงุณุช.
4. **ุงูุฒูุฏู ุตูุญุงุช ุฌุฏุฏ**: ุงุฒ ุขูุฌุง ฺฉู routing SvelteKit ุงุณุชุ ูุณุฑูุง ุฌุฏุฏ ุฑุง ุฏุฑ `src/routes` ุจุณุงุฒุฏ ู ุฏุฑ ุตูุฑุช ูุงุฒ ุงุฒ layout ูุนู ุงุฑุซโุจุฑ ฺฉูุฏ.
5. **ุญูุธ RTL**: ุชูุงู UI ุงุตู ูุงุฑุณ ู RTL ุงุณุชุ ููฺฏุงู ุงูุฒูุฏู ุงุณุชุงู ุฌูุงู ูุฑุงูุจ override ุฌูุช ูุชู ุจุงุดุฏ.


## 11. ูุณุฑูุง ูพุดููุงุฏ ุจุฑุง ุจูุจูุฏ ุขูุฏู

- **Telemetry**: ุซุจุช ุชุนุงููุงุช ฺฉุงุฑุจุฑ (hoverุ select) ุจุฑุง ุชุญูู ุงุณุชูุงุฏู ุงุฒ ููุดู.
- **AI Integrations**: ุงุณุชูุงุฏู ุงุฒ ุฏุงุฏูโูุง ุงุณุชุงูโูุง ุจุฑุง ูพุงุณุฎโ ุจู ุณูุงูุงุช ฺฉุงุฑุจุฑ ุฏุงุฎู ฺฉ ฺุชโุจุงุช (ูโุชูุงูุฏ `provinceNames` ู `provinceColors` ุฑุง ุจู ุตูุฑุช JSON ุณุฑู ฺฉูุฏ).
- **SSR / Streaming**: ุงฺฏุฑ ูุงุฒ ุจู ุฑูุจุงุชโูุง indexer ุจุงุดุฏุ ูโุชูุงู SSR ุฑุง ูุนุงู ฺฉุฑุฏุ ูุนูุงู ุชูุงู ฺุฒ ฺฉู ูุงุฒ ุฏุงุฑุฏ ุฏุฑ ูุงู +layout.js ููุฌูุฏ ุงุณุช.

---

> ูุฑ ุฒูุงู ูุงุฒ ุจูุฏุ ุงู README ุฑุง ุจุง ูุชุฌูโ `exportConfig` ุงุฒ ControlPanel ุจูโุฑูุฒุฑุณุงู ฺฉูุฏ ุชุง snapshot ุฌุฏุฏ ุงุฒ ุชูุธูุงุช ุฌูููโ ุจุตุฑ ุฏุฑ ุฏุณุชุฑุณ ุนุงููโูุง ููุดููุฏ ูุฑุงุฑ ฺฏุฑุฏ.
